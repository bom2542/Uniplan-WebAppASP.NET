@using Microsoft.AspNet.Identity


@if (User.Identity.IsAuthenticated)
{
    ///string identity = User.Identity.GetUserName();

    if (User.Identity.GetUserName() == "admin")
    {
        <!--<p>  I am Admin</p>-->
        ViewBag.Title = "Dashboard Admin";

        //<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
        //<link rel="stylesheet" href="~/css/Style.css" />

        //<link href="https://fonts.googleapis.com/css?family=Montserrat&display=swap" rel="stylesheet">

        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <h2 align="center"><b>Dashboard Management(Admin)</b></h2>
                    <h4><b>ภาพรวมสรุปการใช้งาน</b></h4>
                    <section class="statistics">
                        <div class="container body-content">
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="box">
                                        <i class="fa fa-users fa-fw bg-primary"></i>
                                        <div class="info" id="info">
                                            <span>จำนวนกว่า</span> <h3> @ViewBag.UserCount </h3> <span>คน</span>
                                            <p>ผู้ใช้งานบริการวางแผนการเรียนออนไลน์ของเรา</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="box">
                                        <i class="fa fa-graduation-cap fa-fw danger"></i>
                                        <div class="info" id="info">
                                            <span>จำนวนกว่า </span> <h3> @ViewBag.GoalCount </h3> <span>แผนเป้าหมาย</span>
                                            <p>ที่สนใจในการตั้งเป้าหมายของเรามันดีสุดๆไปเลย</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="box">
                                        <i class="fa fa-check-square-o fa-fw success"></i>
                                        <div class="info" id="info">
                                            <span>จำนวนกว่า </span> <h3> @ViewBag.PlannerCount </h3> <span>แผนแพลนเนอร์</span>
                                            <p>ที่สนใจในการวางแผนประจำวันของพวกเขา</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>

                <!-- เลเอาท์ -->
            </div>
        </div>
        

    }
    else
    {
        ViewBag.Title = "Dashboard Member";
        <!--<p>  I Love Member Wait add Calendar</p>-->
        <div id="calendar" class="container body-content" style="padding-top: 30px"></div>

        <div id="myModal" class="modal fade" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">หัวข้อ : <span id="eventTitle"></span></h4>
                    </div>
                    <div class="modal-body">
                        <p id="pDetails"></p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <link href="//cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.4.0/fullcalendar.min.css" rel="stylesheet" />
        <link href="//cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.4.0/fullcalendar.print.css" rel="stylesheet" media="print" />

        @section Scripts{
            <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.1/moment.min.js"></script>
            <script src="//cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.4.0/fullcalendar.min.js"></script>
            @*<script src="https://fullcalendar.io/js/fullcalendar-2.1.1/lang/th.js"></script>*@

            <script>
                $(document).ready(function () {

                    var events = [];
                    var identity = "@User.Identity.GetUserName()";

                    $.ajax({
                        type: "GET",
                        url: "/home/GetEvents",
                        success: function (data) {
                            $.each(data, function (i, v) {
                                if (v.UserName == identity) {
                                    events.push({
                                        title: v.Topic,
                                        description: v.Description,
                                        start: moment(v.Start),
                                        end: v.End != null ? moment(v.End) : null,
                                        color: v.Color,
                                        allDay: v.Full
                                    });
                                }
                            })
                            //lang: 'th';
                            GenerateCalendar(events);
                        },
                        error: function (error) {
                            alert('failed');
                        }
                    })

                    function GenerateCalendar(events) {
                        $('#calendar').fullCalendar('destroy');
                        $('#calendar').fullCalendar({
                            //lang: 'th',
                            contentHeight: 400,
                            defaultDate: new Date(),
                            timeFormat: 'h(:mm)a',
                            header: {
                                left: 'prev,next today',
                                right: 'title'
                                /*right: 'month,basicWeek,basicDay,agenda'*/
                            },
                            eventLimit: true,
                            eventColor: '#378006',
                            events: events,
                            eventClick: function (calEvent, jsEvent, view) {
                                $('#myModal #eventTitle').text(calEvent.title);
                                var $description = $('<div/>');
                                $description.append($('<p/>').html('<b>วันเริ่มต้น : </b> ' + calEvent.start.format("DD-MMMM-YYYY HH:mm a")));
                                if (calEvent.end != null) {
                                    $description.append($('<p/>').html('<b>วันสิ้นสุด : </b>' + calEvent.end.format("DD-MMMMYYYY HH:mm a")));
                                }
                                $description.append($('<p/>').html('<b>คำอธิบาย : </b>' + calEvent.description));
                                $('#myModal #pDetails').empty().html($description);

                                $('#myModal').modal();
                            }
                        })
                    }
                })
            </script>
        }
    }
}
else
{
    <!--<p>  I Love General User </p>-->
    //การสไลด์ของรูปภาพจ้า
    ViewBag.Title = "Welcome To Uniplan";

    <div id="mycarousel" class="carousel slide" data-ride="carousel">
        <ol class="carousel-indicators">
            <li data-target="#mycarousel" data-slide-to="0" class="active"></li>
            <li data-target="#mycarousel" data-slide-to="1"></li>
            <li data-target="#mycarousel" data-slide-to="2"></li>
            <li data-target="#mycarousel" data-slide-to="3"></li>
            <li data-target="#mycarousel" data-slide-to="4"></li>
        </ol>
        <div class="carousel-inner" role="listbox">

            <div class="item active">
                <img src="~/Content/images/banner1920-400/header1.png" />
            </div>

            <div class="item">
                <img src="~/Content/images/banner1920-400/calender.png" />
            </div>

            <div class="item">
                <img src="~/Content/images/banner1920-400/PLANNER.png" />
            </div>

            <div class="item">
                <img src="~/Content/images/banner1920-400/goal.png" />
            </div>

            <div class="item">
                <img src="~/Content/images/banner1920-400/schdule.png" />
            </div>


            <!--ปุ่มสไลด์ซ้าย-->
            <a class="left carousel-control" href="#mycarousel" role="button" data-slide="prev">
                <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>

            <!--ปุ่มสไลด์ขวา-->
            <a class="right carousel-control" href="#mycarousel" role="button" data-slide="next">
                <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>

        </div>
    </div>

    <div class="container body-content">
        <div class="row">
            <div class="col-md-12">
                <h3 align="center"><b>เพราะเราภูมิใจที่จะนำเสนอ</b></h3>
                <section class="statistics">
                    <div class="container body-content">
                        <div class="row">
                            <div class="col-md-4">
                                <div class="box">
                                    <i class="fa fa-users fa-fw bg-primary"></i>
                                    <div class="info" id="info">
                                        <span>จำนวนกว่า</span> <h3> @ViewBag.UserCount </h3> <span>คน</span>
                                        <p>ผู้ใช้งานบริการวางแผนการเรียนออนไลน์ของเรา</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="box">
                                    <i class="fa fa-graduation-cap fa-fw danger"></i>
                                    <div class="info" id="info">
                                        <span>จำนวนกว่า </span> <h3> @ViewBag.GoalCount </h3> <span>แผนเป้าหมาย</span>
                                        <p>ที่สนใจในการตั้งเป้าหมายของเรามันดีสุดๆไปเลย</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="box">
                                    <i class="fa fa-check-square-o fa-fw success"></i>
                                    <div class="info" id="info">
                                        <span>จำนวนกว่า </span> <h3> @ViewBag.PlannerCount </h3> <span>แผนแพลนเนอร์</span>
                                        <p>ที่สนใจในการวางแผนประจำวันของพวกเขา</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>
}

